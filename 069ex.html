<!-- //자판기에 남아있는 잔돈까지 -->
<!-- 가능한 목록 불 들어오게 -->

<!DOCTYPE html>
<html lang="en">

<head>

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css"
        integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous" />
    <title>자판기</title>

    <style>
        header,
        main,
        footer {
            border: 2px solid black;
            border-collapse: collapse;
            display: flex;
            flex-wrap: wrap;
        }

        * {
            box-sizing: border-box;
            /* margin: 0%; */
            border-collapse: collapse;
        }

        a {
            text-decoration: none;
        }

        body {
            width: 70%;
        }

        header {}

        .drink {
            flex: 25%;
            text-align: center;
            border: 1px solid black;
        }



        main {}

        main>button {
            flex: 33%;
        }

        main>div {
            color: blanchedalmond;
            background-color: black;
            flex: 25%;
            /* padding: ; */
            text-align: right;
        }

        .drink>button {
            background-color: gray;
            width: 100%;
        }

        input {
            width: 100%;
            text-align: right;
        }


        footer {
            height: 200px;
            overflow-y: auto;
        }

        .systemMassege {}
    </style>

</head>

<body>

    <header>
        <div class="drink">
            <button class="a4" onclick="useCoin('a4')">물<br>700
                <br>재고:<span value="" id="a4">5</span>
            </button>
        </div>
        <div class="drink">
            <button class="a5" onclick="useCoin('a5')">보리차<br>1200
                <br>재고:<span value="" id="a5">5</span></button>
        </div>
        <div class="drink">c</div>
        <div class="drink">d</div>
        <div class="drink">
            <button class="a3" onclick="useCoin('a3')">커피<br>500
                <br>재고:<span value="" id="a3">5</span></button>
        </div>
        <div class="drink">f</div>
        <div class="drink">g</div>
        <div class="drink">h</div>
        <div class="drink">
            <button class="a1" onclick="useCoin('a1')">코카콜라<br>700
                <br>재고:<span value="" id="a1">5</span></button>
        </div>
        <div class="drink">
            <button class="a6" onclick="useCoin('a6')">포카리<br>1000
                <br>재고:<span value="" id="a6">5</span></button>
        </div>
        <div class="drink">
            <button class="a7" onclick="useCoin('a7')">뽀로로<br>1300
                <br>재고:<span value="" id="a7">5</span></button>
        </div>
        <div class="drink">d</div>
        <div class="drink">
            <button class="a2" onclick="useCoin('a2')">오렌지주스<br>1200
                <br>재고:<span value="" id="a2">5</span></button>
        </div>
        <div class="drink">f</div>
        <div class="drink">g</div>
        <div class="drink">h</div>
    </header>

    <main>

        <button class="coin" id="c100" onclick="inCoin(100);">100원 투입</button>
        <button class="coin" id="c500" onclick="inCoin(500);">500원 투입</button>
        <button class="coin" id="c1000" onclick="inCoin(1000);">1000원 투입</button>


        <div>소지금액</div>
        <div><input type="text" name="" id="myCoin" value="10000" readonly>
        </div>
        <div> 사용가능금액 </div>
        <div>
            <input type="text" name="" id="useableCoinI" value="0" onchange="colorChange()" readonly>
        </div>
        <button id="returnCoinI" onclick="returnCoin()">반환</button>


    </main>
    <footer>
        <div id="systemMassege">
            <!-- <textarea class="" name="" id="systemMassege" cols="75%" rows="10" readonly></textarea> -->
        </div>

    </footer>


    <script>
        // //소지금액
        // var useableCoin = 10000;

        // //소지금액 줄어들기
        // function useableCoin(투입금액) {

        //     // used 클릭한 버튼의 가격

        //     return useableCoin -= 투입금액;
        // }


        //사용가능 금액
        var inCoinV = 0;
        var money = 10000;
        // var sumInCoinV = 0;
        var p = [];

        //돈을 넣으면 사용가능금액 보여주기(돈 버튼)    
        function inCoin(coin11) {
            if (money >= coin11) {

                money -= coin11;
                inCoinV += coin11;
                // return inCoinV
                // console.log(inCoinV);

                // output.insertAdjacentHTML("#useableCoinI", `<p>${inCoinV}를 투입할 수 없습니다.</p>`);

                // document.querySelector("useableCoinI").innerHTML = '(incoinv)'.value;
                // document.getElementById("total_input_amount").value = total_input_amount;

                document.getElementById("useableCoinI").value = inCoinV;
                document.getElementById("myCoin").value = money;

                systemMassege.insertAdjacentHTML("beforeend", `<p>${coin11}원을 넣었습니다.</p>`);
                systemMassege.insertAdjacentHTML("beforeend", `<p>소지금액은 ${coin11}원이 줄어든 ${money}입니다.</p>`);


            } else {
                // document.getElementById("systemMassege").innerHTML = '소지금액이 부족합니다.'
                systemMassege.insertAdjacentHTML("beforeend", `<p>소지금액이 ${money}원 입니다.</p>`);
                systemMassege.insertAdjacentHTML("beforeend", `<p>${coin11}원을 넣을 수 없습니다.</p>`);


            }
            document.getElementById("systemMassege").scrollTop = document.getElementById("systemMassege").scrollHeight;
            // systemMassege.scrollTop = systemMassege.scrollHeight;
        }

        //사용가능금액으로 보여주기

        // sumInCoinV = 0 + 100;

        // console.log(inCoinV);

        let drinkList = [{
                drinkId: "a1",
                drinkName: "코카콜라",
                price: 700,
                stock: 5
            },
            {
                drinkId: "a2",
                drinkName: "오렌지주스",
                price: 1200,
                stock: 5
            },
            {
                drinkId: "a3",
                drinkName: "커피",
                price: 500,
                stock: 5
            },
            {
                drinkId: "a4",
                drinkName: "물",
                price: 700,
                stock: 5
            },
            {
                drinkId: "a5",
                drinkName: "보리차",
                price: 1200,
                stock: 5
            },
            {
                drinkId: "a6",
                drinkName: "포카리",
                price: 1000,
                stock: 5
            },
            {
                drinkId: "a7",
                drinkName: "뽀로로",
                price: 1300,
                stock: 5
            }
        ];

        // var saveStock;
        //사용하는 금액
        function useCoin(drinkId) {

            var output = drinkList.filter((did) => did.drinkId == drinkId)[0];
            // console.log(output);
            if (output.stock > 0) {
                if (inCoinV >= output.price) {
                    inCoinV -= output.price;
                    output.stock -= 1;
                    var saveStock = output.stock;
                    var drinkId = output.drinkId;
                    // console.log(drinkId);
                    // document.getElementById("water").value = output.stock;
                    // console.log(inCoinV);
                    document.getElementById(drinkId).innerHTML = saveStock;


                    systemMassege.insertAdjacentHTML("beforeend", `<p>${output.price}원을 사용했습니다.</p>`);
                    systemMassege.insertAdjacentHTML("beforeend",
                        `<p>사용가능금액은 ${output.price}원이 줄어든 ${inCoinV}원 입니다.</p>`);

                }
            } else {
                systemMassege.insertAdjacentHTML("beforeend", `<p>${output.drinkName}의 재고가 부족합니다.</p>`);

            }
            if (output.price > inCoinV) {
                var notEnough = output.price - inCoinV;

                systemMassege.insertAdjacentHTML("beforeend",
                    `<p>사용가능금액은 ${inCoinV}원 입니다.</p>`
                );
                systemMassege.insertAdjacentHTML("beforeend",
                    `<p>${output.drinkName}을 사기에는 ${notEnough}원 부족합니다.</p>`
                );
                systemMassege.insertAdjacentHTML("beforeend",
                    `<p>${notEnough}원을 더 투입하세요. </p>`
                );
            }

            document.getElementById("useableCoinI").value = inCoinV;

        }

        //반환버튼 누르면 사용가능 금액을 소지금액에 더해주는것
        function returnCoin() {

            systemMassege.insertAdjacentHTML("beforeend", `<p>${inCoinV}원을 반환했습니다.</p>`);

            money += inCoinV;
            var inCoinV2 = inCoinV;
            inCoinV = 0;
            document.getElementById("useableCoinI").value = inCoinV;
            document.getElementById("myCoin").value = money;


            systemMassege.insertAdjacentHTML("beforeend", `<p>소지금액은 ${inCoinV2}원 추가된 ${money}원 입니다.</p>`);

        }

        // document.querySelector("#water").insertAdjacentText = 'output.stock'


        // console.log(drinkList);

        //살 수 있는 음료 색 변하기
        function colorChange() {
            for (var price1 of drinkList) {
                if (inCoinV >= price1.price)
                    var colorC = price1.drinkId
                // document.getElementsByClassName(colorC).style.backgroundcolor = red;
                //클래스 이름으로 버튼에 접근해서 백그라운드 컬러를 바꾼다.
            }
        }





        // var drink = drinkList.filter(d => d.drinkId == drinkId)[0];

        // var drink = null;
        // for (var d of drinkList) {
        //     if (d.drinkId == drinkId) {
        //         drink = d;
        //         break;
        //     }
        // }

        //     inConinV -= ;
        //     return inConinV;
        // }

        // var output = userList.filter(function (user) {
        //     return user.gender == "female";
        // });



        // //반환버튼 누르면 사용가능 금액을 소지금액에 추가시켜주기
        // function returnCoin() {
        //     return useableCoin += inConinv;
        // }






        // document.querySelector("#myCoin").innerHTML = useableCoin(); //innerHTML 안에 이것 넣어줘
        // document.getElementById("c100").click();
    </script>

</body>

</html>